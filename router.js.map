{"version":3,"sources":["/router.js"],"names":["serialize","isEmptyObject","obj","Reflect","ownKeys","length","getURLInfo","str","a","indexOf","b","querystring","hashstring","qo","ho","host","port","protocol","substring","_port","match","_protocol","_host","c","split","i","d","len","query","hash","queryObject","hashObject","Agent","constructor","context","_context","add","data","title","url","window","history","pushState","replace","replaceState","onChange","fn","onpopstate","e","Router","map","list","hasDot","location","href","path","has","count","start","pars","pathx","push","info","originalpath","pattern","RegExp","patternString","firstposition","keys","callback","aStrings","suffix","check","result","found","hasParas","matchpath","t","bString","test","p","pp","cd","History","origin","_stack","_currentIndex","_handler","router","agent","_run","call","state","__page__","__index__","r","isback","isforward","Object","assign","undefined","_pdata","founded","action","back","forward","baseInfo","_cannext","beforeopen","endopen","nofound","console","log","run","page","open","edit","bind","arguments","watch","type","module","exports"],"mappings":"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","sourcesContent":["let serialize = {\n\tisEmptyObject(obj) {\n\t\treturn Reflect.ownKeys(obj).length > 0;\n\t},\n\tgetURLInfo: function (str) {\n\t\tlet a = str.indexOf(\"?\"), b = str.indexOf(\"#\"), querystring = \"\",\n\t\t\thashstring = \"\", qo = null, ho = null, host = str, port = null, protocol = null;\n\t\tif (a !== -1 && b !== -1) {\n\t\t\thost = str.substring(0, a);\n\t\t\tif (a > b) {\n\t\t\t\thashstring = str.substring(b + 1, a);\n\t\t\t\tquerystring = str.substring(a + 1);\n\t\t\t} else {\n\t\t\t\tquerystring = str.substring(a + 1, b);\n\t\t\t\thashstring = str.substring(b + 1);\n\t\t\t}\n\t\t} else if (a !== -1) {\n\t\t\tquerystring = str.substring(a + 1);\n\t\t\thost = str.substring(0, a);\n\t\t} else if (b !== -1) {\n\t\t\thashstring = str.substring(b + 1);\n\t\t\thost = str.substring(0, b);\n\t\t}\n\t\tlet _port = str.match(/:[0-9]+/g), _protocol = str.match(/[a-z]+:\\/\\//);\n\t\tport = _port ? _port[_port.length - 1].substring(1) : null;\n\t\tprotocol = _protocol ? _protocol[0].substring(0, _protocol[0].length - 3) : null;\n\t\tif (protocol) {\n\t\t\thost = host.substring(protocol.length + 3);\n\t\t}\n\t\tif (port) {\n\t\t\thost = host.substring(0, host.length - port.length - 1);\n\t\t}\n\t\tlet _host = host.substring(0, host.indexOf(\"/\"));\n\t\thost = _host === \"\" ? host : _host;\n\t\tif (querystring !== \"\") {\n\t\t\tqo = {};\n\t\t\tlet c = querystring.split(\"&\");\n\t\t\tfor (let i = 0; i < c.length; i++) {\n\t\t\t\tlet d = c[i].split(\"=\");\n\t\t\t\tqo[d[0]] = d[1];\n\t\t\t}\n\t\t}\n\t\tif (hashstring !== \"\") {\n\t\t\tho = {};\n\t\t\tlet c = hashstring.split(\"&\");\n\t\t\tfor (let i = 0, len = c.length; i < len; i++) {\n\t\t\t\tlet d = c[i].split(\"=\");\n\t\t\t\tho[d[0]] = d[1];\n\t\t\t}\n\t\t}\n\t\treturn {\n\t\t\tquery: qo,\n\t\t\thash: ho,\n\t\t\thost: host,\n\t\t\tport: port,\n\t\t\tprotocol: protocol\n\t\t};\n\t},\n\tqueryObject: function (str) {\n\t\treturn serialize.getURLInfo(str).query;\n\t},\n\thashObject: function (str) {\n\t\treturn serialize.getURLInfo(str).hash;\n\t}\n};\n\nclass Agent {\n\tconstructor(context) {\n\t\tthis._context = context;\n\t}\n\n\tadd(data, title, url) {\n\t\tthis._context.window.history.pushState(data, title, url);\n\t\treturn this;\n\t}\n\n\treplace(data, title, url) {\n\t\tthis._context.window.history.replaceState(data, title, url);\n\t\treturn this;\n\t}\n\n\tonChange(fn) {\n\t\tthis._context.window.onpopstate = function (e) {\n\t\t\tfn && fn(e);\n\t\t};\n\t}\n}\n\nclass Router {\n\tconstructor(context) {\n\t\tthis._context = context;\n\t\tthis.map = [];\n\t\tthis.list = [];\n\t\tthis.hasDot = /\\{\\w*\\}/g;\n\t\tthis.url = this._context.window.location.href;\n\t}\n\n\tadd(path, fn) {\n\t\tif (path[path.length - 1] !== \"/\") {\n\t\t\tpath = path + \"/\";\n\t\t}\n\t\tlet has = false, count = 0, start = 0, pars = [];\n\t\tlet pathx = path.replace(this.hasDot, function (a, b) {\n\t\t\thas = true;\n\t\t\tif (count === 0) {\n\t\t\t\tstart = b;\n\t\t\t}\n\t\t\tpars.push(a.substring(1, a.length - 1));\n\t\t\tcount++;\n\t\t\treturn \"((?!/).)*\";\n\t\t});\n\t\tif (has) {\n\t\t\tlet info = {};\n\t\t\tinfo.originalpath = path;\n\t\t\tinfo.pattern = new RegExp(\"^\" + pathx + \"$\");\n\t\t\tinfo.count = count;\n\t\t\tinfo.patternString = \"^\" + pathx + \"/$\";\n\t\t\tinfo.firstposition = start;\n\t\t\tinfo.keys = pars;\n\t\t\tinfo.callback = fn;\n\t\t\tlet aStrings = path.split(\"\\\\.\");\n\t\t\tif (aStrings.length > 1) {\n\t\t\t\tinfo.suffix = aStrings[1];\n\t\t\t}\n\t\t\tthis.list.push(info);\n\t\t} else {\n\t\t\tthis.map[path] = fn;\n\t\t}\n\t}\n\n\tcheck(path) {\n\t\tlet result = {\n\t\t\tfound: false,\n\t\t\thasParas: false,\n\t\t\tpath: path,\n\t\t\tmatchpath: \"\",\n\t\t\tmap: {},\n\t\t\tquery: serialize.queryObject(path),\n\t\t\thash: serialize.hashObject(path),\n\t\t\tcallback: null\n\t\t};\n\t\tlet t = path.split(\"?\");\n\t\tif (t.length > 1) {\n\t\t\tpath = t[0];\n\t\t}\n\t\tlet suffix = \"\", bString = path.split(\"\\\\.\");\n\t\tif (bString.length > 1) {\n\t\t\tsuffix = bString[1];\n\t\t\tpath = path + \"/\";\n\t\t} else {\n\t\t\tif (bString[0][bString[0] - 1] !== \"/\") {\n\t\t\t\tpath = bString[0] + \"/\";\n\t\t\t}\n\t\t}\n\t\tif (this.map[path]) {\n\t\t\tresult.path = path;\n\t\t\tresult.matchpath = path;\n\t\t\tresult.callback = this.map[path];\n\t\t\tresult.found = true;\n\t\t\treturn result;\n\t\t} else {\n\t\t\tlet a = null;\n\t\t\tfor (let i in this.list) {\n\t\t\t\tlet info = this.list[i];\n\t\t\t\tif (info.pattern.test(path)) {\n\t\t\t\t\tif (null === a) {\n\t\t\t\t\t\ta = info;\n\t\t\t\t\t} else if (info.suffix === suffix) {\n\t\t\t\t\t\tif (info.count <= a.count) {\n\t\t\t\t\t\t\tif (info.firstposition > a.firstposition) {\n\t\t\t\t\t\t\t\ta = info;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (null !== a) {\n\t\t\t\tlet p = path.split(\"/\"), pp = a.originalpath.split(\"/\");\n\t\t\t\tlet cd = 0;\n\t\t\t\tfor (let i = 0; i < pp.length; i++) {\n\t\t\t\t\tif (pp[i][0] === \"{\") {\n\t\t\t\t\t\tresult.map[a.keys[cd]] = p[i];\n\t\t\t\t\t\tcd++;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tresult.hasParas = true;\n\t\t\t\tresult.path = a.originalpath;\n\t\t\t\tresult.matchpath = path;\n\t\t\t\tresult.callback = info.callback;\n\t\t\t\tresult.found = true;\n\t\t\t}\n\t\t\treturn result;\n\t\t}\n\t}\n}\n\nclass History {\n\tconstructor(context) {\n\t\tthis._context = context;\n\t\tthis.url = this._context.window.location.origin;\n\t\tthis._stack = [1];\n\t\tthis._currentIndex = 0;\n\t\tthis._handler = {};\n\t\tthis.router = new Router(context);\n\t\tthis.agent = new Agent(context);\n\t\tthis.agent.onChange((e) => {\n\t\t\tHistory._run.call(this, e.state, e);\n\t\t});\n\t}\n\n\tstatic _run(data, e) {\n\t\ttry {\n\t\t\tif (!data || serialize.isEmptyObject(data)) {\n\t\t\t\tdata = {\n\t\t\t\t\t__page__: this._context.window.location.href.split(\"#\")[0].substring(this.url.length),\n\t\t\t\t\t__index__: 0\n\t\t\t\t};\n\t\t\t}\n\t\t\tdata.__page__ = data.__page__.split(\"?\")[0];\n\t\t\tif (data.__page__ === \"\") {\n\t\t\t\tdata.__page__ = \"/\";\n\t\t\t} else {\n\t\t\t\tif (data.__page__[data.__page__.length - 1] === \"/\") {\n\t\t\t\t\tdata.__page__ = data.__page__.substring(data.__page__.length - 1);\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (data.__page__ === \"/\") {\n\t\t\t\tdata.__page__ = \"\";\n\t\t\t}\n\t\t\tlet r = this.router.check(data.__page__), isback = false, isforward = false;\n\t\t\tlet info = {};\n\t\t\tif (e) {\n\t\t\t\tObject.assign(data, e.state);\n\t\t\t}\n\t\t\tif (data.__index__ !== undefined && data.__index__ !== null) {\n\t\t\t\tif (data.__index__ < this._currentIndex) {\n\t\t\t\t\tisback = true;\n\t\t\t\t}\n\t\t\t\tif (data.__index__ > this._currentIndex) {\n\t\t\t\t\tisforward = true;\n\t\t\t\t}\n\t\t\t\tthis._currentIndex = data.__index__;\n\t\t\t}\n\t\t\tfor (let i in data) {\n\t\t\t\tif (i !== \"__page__\" && i !== \"__title__\" && i !== \"__index__\") {\n\t\t\t\t\tinfo[i] = data[i];\n\t\t\t\t}\n\t\t\t}\n\t\t\tlet _pdata = {\n\t\t\t\tfounded: r.found,\n\t\t\t\taction: r.path,\n\t\t\t\tpath: r.path,\n\t\t\t\tback: isback,\n\t\t\t\tforward: isforward,\n\t\t\t\tkeys: r.hasParas ? r.map : null,\n\t\t\t\tquery: r.query,\n\t\t\t\thash: r.hash,\n\t\t\t\tinfo: info,\n\t\t\t\te: e === undefined ? null : e,\n\t\t\t\tbaseInfo: r\n\t\t\t};\n\t\t\tlet _cannext = true;\n\t\t\tif (this._handler.beforeopen) {\n\t\t\t\tlet r = this._handler.beforeopen.call(this, _pdata);\n\t\t\t\tif (r === false) {\n\t\t\t\t\t_cannext = false;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (r.found) {\n\t\t\t\tif (_cannext) {\n\t\t\t\t\tr.callback && r.callback.call(this, _pdata);\n\t\t\t\t}\n\t\t\t\tthis._handler.endopen && this._handler.endopen.call(this, _pdata);\n\t\t\t} else {\n\t\t\t\tthis._handler.nofound && this._handler.nofound.call(this, _pdata);\n\t\t\t}\n\t\t} catch (e) {\n\t\t\tconsole.log(e);\n\t\t}\n\t}\n\n\trun() {\n\t\tlet page = this._context.window.location.href.substring(this.url.length);\n\t\tHistory._run.call(this, {__page__: page});\n\t\treturn this;\n\t};\n\n\topen(url, data, title) {\n\t\tif (!data) {\n\t\t\tdata = {};\n\t\t}\n\t\tdata[\"__page__\"] = url;\n\t\tdata[\"__title__\"] = title;\n\t\tdata[\"__index__\"] = this._stack.length;\n\t\tthis.agent.add(data, title, this.url + url);\n\t\tthis._stack.push(1);\n\t\tthis._currentIndex = data.__index__;\n\t\tHistory._run.call(this, data);\n\t\treturn this;\n\t};\n\n\tedit(url, data, title) {\n\t\tif (!data) {\n\t\t\tdata = {};\n\t\t}\n\t\tdata[\"__page__\"] = url;\n\t\tthis.agent.replace(data, title, this.url + url);\n\t\tHistory._run.call(this, data);\n\t\treturn this;\n\t};\n\n\tbind(obj, fn) {\n\t\tif (arguments.length === 1) {\n\t\t\tfor (let i in obj) {\n\t\t\t\tthis.router.add(i, obj[i]);\n\t\t\t}\n\t\t} else if (arguments.length === 2) {\n\t\t\tthis.router.add(obj, fn);\n\t\t}\n\t\treturn this;\n\t};\n\n\twatch(type, fn) {\n\t\tthis._handler[type] = fn;\n\t\treturn this;\n\t};\n}\n\nmodule.exports = History;"]}