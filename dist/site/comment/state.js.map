{"version":3,"sources":["/site/comment/state.js"],"names":["CommentService","Service","defaultData","commentId","infos","addIcon","loading","onupdate","current","data","get","context","comment","getIssueCommentsById","then","info","map","id","content","body","time","updated_at","userIcon","user","avatar_url","userPage","login","userId","userName","reduce","a","getMarkdownContent","Promise","resolve"],"mappings":";;;;;;;AAAA;;AACA;;;;;;;;IAEMA,c,WAcJ,mBAAO,KAAP,C,YAdF,MAAMA,cAAN,SAA6BC,cAA7B,CAAqC;AACpCC,EAAAA,WAAW,GAAG;AACb,WAAO;AACNC,MAAAA,SAAS,EAAE,EADL;AAENC,MAAAA,KAAK,EAAE,EAFD;AAGNC,MAAAA,OAAO,EAAPA,YAHM;AAINC,MAAAA,OAAO,EAAE;AAJH,KAAP;AAMA;;AAEDC,EAAAA,QAAQ,CAACC,OAAD,EAAUC,IAAV,EAAgB;AACvBD,IAAAA,OAAO,CAACL,SAAR,GAAoBM,IAAI,CAACN,SAAzB;AACA;;AAGDO,EAAAA,GADA,CACIF,OADJ,EACa;AACZ,WAAO,KAAKG,OAAL,CAAaC,OAAb,CAAqBC,oBAArB,CAA0CL,OAAO,CAACL,SAAlD,EAA6DW,IAA7D,CAAkEC,IAAI,IAAI;AAChFP,MAAAA,OAAO,CAACJ,KAAR,GAAgB,CAACW,IAAI,IAAI,EAAT,EAAaC,GAAb,CAAiBD,IAAI,IAAI;AACxC,eAAO;AACNE,UAAAA,EAAE,EAAEF,IAAI,CAACE,EADH;AAENC,UAAAA,OAAO,EAAEH,IAAI,CAACI,IAFR;AAGNC,UAAAA,IAAI,EAAEL,IAAI,CAACM,UAHL;AAINC,UAAAA,QAAQ,EAAEP,IAAI,CAACQ,IAAL,CAAUC,UAJd;AAKNC,UAAAA,QAAQ,EAAG,sBAAqBV,IAAI,CAACQ,IAAL,CAAUG,KAAM,EAL1C;AAMNC,UAAAA,MAAM,EAAEZ,IAAI,CAACQ,IAAL,CAAUN,EANZ;AAONW,UAAAA,QAAQ,EAAEb,IAAI,CAACQ,IAAL,CAAUG;AAPd,SAAP;AASA,OAVe,CAAhB;AAWA,aAAOlB,OAAO,CAACJ,KAAR,CAAcyB,MAAd,CAAqB,CAACC,CAAD,EAAIf,IAAJ,KAAa;AACxC,eAAOe,CAAC,CAAChB,IAAF,CAAO,MAAM;AACnB,iBAAO,KAAKH,OAAL,CAAaC,OAAb,CAAqBmB,kBAArB,CAAwChB,IAAI,CAACG,OAA7C,EAAsDJ,IAAtD,CAA2DgB,CAAC,IAAI;AACtEf,YAAAA,IAAI,CAACG,OAAL,GAAeY,CAAf;AACA,WAFM,CAAP;AAGA,SAJM,CAAP;AAKA,OANM,EAMJE,OAAO,CAACC,OAAR,EANI,EAMenB,IANf,CAMoB,MAAM;AAChCN,QAAAA,OAAO,CAACF,OAAR,GAAkB,KAAlB;AACA,OARM,CAAP;AASA,KArBM,CAAP;AAsBA;;AAtCmC,C;eAyCtBN,c","sourcesContent":["import { action, Service } from \"adajs\";\nimport addIcon from \"./icons/add.icon\";\n\nclass CommentService extends Service {\n\tdefaultData() {\n\t\treturn {\n\t\t\tcommentId: \"\",\n\t\t\tinfos: [],\n\t\t\taddIcon,\n\t\t\tloading: true\n\t\t};\n\t}\n\n\tonupdate(current, data) {\n\t\tcurrent.commentId = data.commentId;\n\t}\n\n\t@action(\"get\")\n\tget(current) {\n\t\treturn this.context.comment.getIssueCommentsById(current.commentId).then(info => {\n\t\t\tcurrent.infos = (info || []).map(info => {\n\t\t\t\treturn {\n\t\t\t\t\tid: info.id,\n\t\t\t\t\tcontent: info.body,\n\t\t\t\t\ttime: info.updated_at,\n\t\t\t\t\tuserIcon: info.user.avatar_url,\n\t\t\t\t\tuserPage: `https://github.com/${info.user.login}`,\n\t\t\t\t\tuserId: info.user.id,\n\t\t\t\t\tuserName: info.user.login\n\t\t\t\t}\n\t\t\t});\n\t\t\treturn current.infos.reduce((a, info) => {\n\t\t\t\treturn a.then(() => {\n\t\t\t\t\treturn this.context.comment.getMarkdownContent(info.content).then(a => {\n\t\t\t\t\t\tinfo.content = a;\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t}, Promise.resolve()).then(() => {\n\t\t\t\tcurrent.loading = false;\n\t\t\t});\n\t\t});\n\t}\n}\n\nexport default CommentService;"]}