{"version":3,"sources":["/site/container/index.js"],"names":["Container","className","template","style","dataset","service","ContainerService","BondViewGroup","oncreated","comment","Comment","context","add","window","location","href","indexOf","history","replaceState","split","login","then","commit","session","userinfo","catch","e","console","log","_router","router","Router","getCurrentState","menu","forEach","item","bind","link","onready","run","tags","Menu","content","Content","flip","data","innerWidth","open","closeWin","openWin","getLoginURL"],"mappings":";;;;;;;AAAA;;AACA;;AACA;;AACA;;AACA;;AACA;;;;;;;;IAUMA,S,WARL,iBAAK;AACFC,EAAAA,SAAS,EAAE,WADT;AAEFC,EAAAA,QAAQ,EAAE,iBAFR;AAGFC,EAAAA,KAAK,EAAE,cAHL;AAIFC,EAAAA,OAAO,EAAE;AACLC,IAAAA,OAAO,EAAEC;AADJ;AAJP,CAAL,C,UAsCI,oBAAQ,MAAR,C,UASA,oBAAQ,UAAR,C,UAKA,oBAAQ,SAAR,C,UAKA,oBAAQ,OAAR,C,2BAzDL,MAQMN,SARN,SAQwBO,oBARxB,CAQsC;AAClCC,EAAAA,SAAS,GAAG;AACR,QAAIC,OAAO,GAAG,IAAIC,gBAAJ,CAAY,KAAKC,OAAjB,CAAd;AACA,SAAKV,SAAL,CAAeW,GAAf,CAAmB,OAAnB;;AACA,QAAIC,MAAM,CAACC,QAAP,CAAgBC,IAAhB,CAAqBC,OAArB,CAA6B,OAA7B,MAA0C,CAAC,CAA/C,EAAkD;AAC9CH,MAAAA,MAAM,CAACI,OAAP,CAAeC,YAAf,CAA4B,EAA5B,EAAgC,EAAhC,EAAoCL,MAAM,CAACC,QAAP,CAAgBC,IAAhB,CAAqBI,KAArB,CAA2B,GAA3B,EAAgC,CAAhC,CAApC;AACH;;AACDV,IAAAA,OAAO,CAACW,KAAR,GAAgBC,IAAhB,CAAqB,MAAM;AACvB,WAAKC,MAAL,CAAY,aAAZ,EAA2Bb,OAAO,CAACc,OAAR,CAAgBC,QAA3C;AACH,KAFD,EAEGC,KAFH,CAESC,CAAC,IAAEC,OAAO,CAACC,GAAR,CAAYF,CAAZ,CAFZ;AAGA,SAAKf,OAAL,CAAaF,OAAb,GAAuBA,OAAvB;;AACA,QAAIoB,OAAO,GAAG,KAAKC,MAAL,GAAc,IAAIC,gBAAJ,CAAW,KAAKpB,OAAhB,CAA5B;;AACA,SAAKqB,eAAL,GAAuBC,IAAvB,CAA4BC,OAA5B,CAAoCC,IAAI,IAAI;AACxCN,MAAAA,OAAO,CAACO,IAAR,CAAaD,IAAI,CAACE,IAAL,KAAc,GAAd,GAAoB,GAApB,GAA0BF,IAAI,CAACE,IAA5C,EAAmDX,CAAD,IAAO;AACrD,aAAKJ,MAAL,CAAY,MAAZ,EAAoBa,IAAI,CAACE,IAAzB;AACH,OAFD;AAGH,KAJD;AAKH;;AAEDC,EAAAA,OAAO,GAAG;AACN,SAAKR,MAAL,CAAYS,GAAZ;AACH;;AAEDC,EAAAA,IAAI,GAAG;AACH,WAAO;AACHP,MAAAA,IAAI,EAAEQ,aADH;AAEHC,MAAAA,OAAO,EAAEC;AAFN,KAAP;AAIH;;AAGDC,EAAAA,IADA,CACK;AAACC,IAAAA;AAAD,GADL,EACa;AACT,QAAIhC,MAAM,CAACiC,UAAP,IAAqB,IAAzB,EAA+B;AAC3B,WAAKxB,MAAL,CAAY,OAAZ,EAAqBD,IAArB,CAA0B,MAAM,KAAKS,MAAL,CAAYiB,IAAZ,CAAiBF,IAAjB,CAAhC;AACH,KAFD,MAEO;AACH,WAAKf,MAAL,CAAYiB,IAAZ,CAAiBF,IAAjB;AACH;AACJ;;AAGDG,EAAAA,QADA,GACW;AACP,SAAK1B,MAAL,CAAY,OAAZ;AACH;;AAGD2B,EAAAA,OADA,GACU;AACN,SAAK3B,MAAL,CAAY,MAAZ;AACH;;AAGDF,EAAAA,KADA,GACQ;AACJP,IAAAA,MAAM,CAACC,QAAP,CAAgBC,IAAhB,GAAuB,KAAKJ,OAAL,CAAaF,OAAb,CAAqByC,WAArB,EAAvB;AACH;;AApDiC,C;eAuDvBlD,S","sourcesContent":["import {BondViewGroup, handler, view} from \"adajs\";\nimport ContainerService from \"./state.js\";\nimport Menu from \"./../menu\";\nimport Content from \"./../content\";\nimport Router from \"./../../router\";\nimport Comment from \"./../../lib/comment\";\n\n@view({\n    className: \"container\",\n    template: \"./template.html\",\n    style: \"./style.scss\",\n    dataset: {\n        service: ContainerService\n    }\n})\nclass Container extends BondViewGroup {\n    oncreated() {\n        let comment = new Comment(this.context);\n        this.className.add(\"close\");\n        if (window.location.href.indexOf(\"code=\") !== -1) {\n            window.history.replaceState({}, \"\", window.location.href.split(\"?\")[0]);\n        }\n        comment.login().then(() => {\n            this.commit(\"setuserinfo\", comment.session.userinfo);\n        }).catch(e=>console.log(e));\n        this.context.comment = comment;\n        let _router = this.router = new Router(this.context);\n        this.getCurrentState().menu.forEach(item => {\n            _router.bind(item.link === \"/\" ? \"/\" : item.link, (e) => {\n                this.commit(\"flip\", item.link);\n            });\n        });\n    }\n\n    onready() {\n        this.router.run();\n    }\n\n    tags() {\n        return {\n            menu: Menu,\n            content: Content\n        }\n    }\n\n    @handler(\"flip\")\n    flip({data}) {\n        if (window.innerWidth <= 1000) {\n            this.commit(\"close\").then(() => this.router.open(data));\n        } else {\n            this.router.open(data);\n        }\n    }\n\n    @handler(\"closewin\")\n    closeWin() {\n        this.commit(\"close\");\n    }\n\n    @handler(\"openwin\")\n    openWin() {\n        this.commit(\"open\");\n    }\n\n    @handler(\"login\")\n    login() {\n        window.location.href = this.context.comment.getLoginURL();\n    }\n}\n\nexport default Container;\n"]}